syntax = "proto3";

package opendut.carl.services.peer_messaging_broker;

import "opendut/model/peer/configuration/api.proto";

service PeerMessagingBroker {
  rpc Open(stream Upstream) returns (stream Downstream);
}

message Upstream {
  TracingContext context = 1;
  oneof message {
    Ping ping = 2;
    opendut.model.peer.configuration.api.EdgePeerConfigurationState edge_peer_configuration_state = 3;
  }
}

message Downstream {
  TracingContext context = 1;
  oneof message {
    Pong pong = 2;
    ApplyPeerConfiguration apply_peer_configuration = 3;
    DisconnectNotice disconnect_notice = 4;
  }
}

message Ping {}
message Pong {}
message DisconnectNotice {}


message ApplyPeerConfiguration {
  opendut.model.peer.configuration.api.PeerConfiguration configuration = 1;
}

message TracingContext {
  map<string, string> values = 1;
}
